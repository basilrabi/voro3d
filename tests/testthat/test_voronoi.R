library(voro3d)

geom <- voronoi(c(0, 2), c(0, 0), c(0, 0), 2)

test_that("voronoi() works", {
  expect_equal(geom[1],
               "POLYHEDRALSURFACE(((1.000000 -1.000000 -1.000000, 1.000000 -1.000000 1.000000, 1.000000 1.000000 1.000000, 1.000000 -1.000000 -1.000000)), ((1.000000 -1.000000 -1.000000, 1.000000 1.000000 1.000000, 1.000000 1.000000 -1.000000, 1.000000 -1.000000 -1.000000)), ((1.000000 -1.000000 -1.000000, -1.000000 -1.000000 -1.000000, -1.000000 -1.000000 1.000000, 1.000000 -1.000000 -1.000000)), ((1.000000 -1.000000 -1.000000, -1.000000 -1.000000 1.000000, 1.000000 -1.000000 1.000000, 1.000000 -1.000000 -1.000000)), ((1.000000 -1.000000 -1.000000, 1.000000 1.000000 -1.000000, -1.000000 1.000000 -1.000000, 1.000000 -1.000000 -1.000000)), ((1.000000 -1.000000 -1.000000, -1.000000 1.000000 -1.000000, -1.000000 -1.000000 -1.000000, 1.000000 -1.000000 -1.000000)), ((-1.000000 1.000000 -1.000000, -1.000000 1.000000 1.000000, -1.000000 -1.000000 1.000000, -1.000000 1.000000 -1.000000)), ((-1.000000 1.000000 -1.000000, -1.000000 -1.000000 1.000000, -1.000000 -1.000000 -1.000000, -1.000000 1.000000 -1.000000)), ((-1.000000 1.000000 -1.000000, 1.000000 1.000000 -1.000000, 1.000000 1.000000 1.000000, -1.000000 1.000000 -1.000000)), ((-1.000000 1.000000 -1.000000, 1.000000 1.000000 1.000000, -1.000000 1.000000 1.000000, -1.000000 1.000000 -1.000000)), ((-1.000000 -1.000000 1.000000, -1.000000 1.000000 1.000000, 1.000000 1.000000 1.000000, -1.000000 -1.000000 1.000000)), ((-1.000000 -1.000000 1.000000, 1.000000 1.000000 1.000000, 1.000000 -1.000000 1.000000, -1.000000 -1.000000 1.000000)))")
  expect_equal(geom[2],
               "POLYHEDRALSURFACE(((3.000000 -1.000000 -1.000000, 3.000000 1.000000 -1.000000, 1.000000 1.000000 -1.000000, 3.000000 -1.000000 -1.000000)), ((3.000000 -1.000000 -1.000000, 1.000000 1.000000 -1.000000, 1.000000 -1.000000 -1.000000, 3.000000 -1.000000 -1.000000)), ((3.000000 -1.000000 -1.000000, 3.000000 -1.000000 1.000000, 3.000000 1.000000 1.000000, 3.000000 -1.000000 -1.000000)), ((3.000000 -1.000000 -1.000000, 3.000000 1.000000 1.000000, 3.000000 1.000000 -1.000000, 3.000000 -1.000000 -1.000000)), ((3.000000 -1.000000 -1.000000, 1.000000 -1.000000 -1.000000, 1.000000 -1.000000 1.000000, 3.000000 -1.000000 -1.000000)), ((3.000000 -1.000000 -1.000000, 1.000000 -1.000000 1.000000, 3.000000 -1.000000 1.000000, 3.000000 -1.000000 -1.000000)), ((1.000000 1.000000 -1.000000, 1.000000 1.000000 1.000000, 1.000000 -1.000000 1.000000, 1.000000 1.000000 -1.000000)), ((1.000000 1.000000 -1.000000, 1.000000 -1.000000 1.000000, 1.000000 -1.000000 -1.000000, 1.000000 1.000000 -1.000000)), ((1.000000 1.000000 -1.000000, 3.000000 1.000000 -1.000000, 3.000000 1.000000 1.000000, 1.000000 1.000000 -1.000000)), ((1.000000 1.000000 -1.000000, 3.000000 1.000000 1.000000, 1.000000 1.000000 1.000000, 1.000000 1.000000 -1.000000)), ((1.000000 -1.000000 1.000000, 1.000000 1.000000 1.000000, 3.000000 1.000000 1.000000, 1.000000 -1.000000 1.000000)), ((1.000000 -1.000000 1.000000, 3.000000 1.000000 1.000000, 3.000000 -1.000000 1.000000, 1.000000 -1.000000 1.000000)))")
  expect_error(voronoi(c(1), c(1), c(1), 1), "Cannot generate cells if points are less than 2.")
  expect_error(voronoi(c(1, 2), c(1, 2), c(1, 2), 0.9), "Invalid containerRatio: Value must not be less than 1.")
  expect_error(voronoi(c(1), c(1, 2), c(1), 0.9), "Lengths of coordinate vectors are not equal.")
  expect_error(voronoi(c(1), c(1), c(1, 2), 0.9), "Lengths of coordinate vectors are not equal.")
})